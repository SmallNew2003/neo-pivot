# 0011：架构决策——模块化单体优先，不上微服务

## 状态

已决定

## 背景

项目目标是以有限周期交付可演示闭环，并在面试场景突出工程能力（边界、权限、数据一致性、可观测性）。若早期直接上微服务，将带来：

- 分布式复杂度：服务间通信、配置中心、注册发现、链路追踪、分布式事务等
- 开发与运维成本显著增加：本地/CI 环境更难复现
- 模块边界不清时拆分成本更高：容易把“坏边界”固化到服务边界

## 决策

- MVP 与早期迭代采用模块化单体（Modular Monolith）。
- 通过模块边界与依赖方向约束来获得“可演进的架构”，在需要时再按边界拆微服务。

## 具体约束

- 模块间优先事件驱动解耦（应用内事件），避免直接跨模块调用内部实现。
- 核心底座对外 API 语义稳定，平台适配通过“适配层”实现，避免把平台差异引入领域模型。

## 影响与权衡

优点：

- 交付更快，本地可复现，面试讲解更聚焦。
- 边界可先在代码层被强制，再在部署层拆分。

代价：

- 无法天然获得微服务的独立扩缩容与部署隔离（但 MVP 阶段不需要）。

## 何时考虑拆微服务（触发条件）

- 明确的团队协作边界与独立发布需求
- 明确的性能/隔离需求（例如索引 worker 需要单独扩容）
- 模块边界稳定且有成熟的观测、发布与回滚能力

