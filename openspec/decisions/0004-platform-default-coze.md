# 0004：MVP 默认平台入口选择 Coze（扣子）

## 状态

已决定

## 背景

项目希望在不牺牲 Java 原生底座技术深度的前提下，提供一个“可快速交付与多端触达”的上层入口，用于承载对话体验与应用发布；同时保持底座能力（存储/索引/权限/检索）不绑定平台，便于后续对接 Dify/n8n 等。

## 决策

- MVP 默认平台入口选择 `Coze`。
- `Coze` 作为“上层平台/应用承载与编排入口”，不作为底座层的 LLM Provider。

非绑定约定：

- 选择 Coze 仅作为 MVP 阶段“默认入口”的交付策略，不构成平台锁定。
- 任何平台相关差异必须限制在“适配层”，核心底座 API/领域模型保持平台中立。
- 后续可按场景替换或新增平台入口（例如 Dify、n8n、Web/小程序前端），不应要求重构核心底座。

## 接入方式（设计约定）

- Coze 通过适配层调用核心底座的能力（检索/问答/状态查询等），或由核心底座作为 Coze 工具（tool）被调用。
- 核心底座保持索引与权限过滤的权威性，避免平台侧重复实现一套 RAG 真相来源。

## 可行性判断（落地前必须确认）

为了判定 Coze 作为默认平台入口的落地可行性，需要在实现前确认：

- 平台侧是否支持调用外部 HTTP 工具（tool）以及请求鉴权方式。
- 平台侧对调用超时、重试、并发与配额的限制。
- 平台侧对返回内容（citations/结构化字段）的承载能力与展示能力。

## 影响与权衡

优点：

- 交付快：Coze 更偏应用侧与多端触达，可作为演示入口降低前端投入。
- 架构清晰：底座能力不绑定平台，便于后续按场景接入 Dify/n8n。

代价：

- 需要维护平台适配层与配置管理。
- 平台能力边界（工具调用、结构化输出、配额）会影响部分体验，需要提前验证。

## 后续工作

- 补齐 Coze 的“工具调用”对接细节（鉴权、超时、重试、结构化返回）。
- LLM/Embedding Provider 的默认落地选择另行 decision（与 Coze 平台入口解耦）。
